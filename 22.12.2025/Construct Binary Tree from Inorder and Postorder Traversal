class Solution {
    public TreeNode buildTree(int[] inorder, int[] postorder) {
        return build(postorder, 0, postorder.length - 1,
                     inorder, 0, inorder.length - 1);
    }

    private TreeNode build(int[] post, int postStart, int postEnd,
                           int[] in, int inStart, int inEnd) {
        if (postStart > postEnd) return null;

        TreeNode root = new TreeNode(post[postEnd]);
        int inRoot = inStart;
        while (in[inRoot] != root.val) inRoot++;

        int leftSize = inRoot - inStart;
        root.left = build(post, postStart, postStart + leftSize - 1,
                          in, inStart, inRoot - 1);
        root.right = build(post, postStart + leftSize, postEnd - 1,
                           in, inRoot + 1, inEnd);
        return root;
    }
}
